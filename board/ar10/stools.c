static  char data [] = 
#define      rlax_z	1
#define      rlax	((&data[0]))
	"\375"
#define      pswd_z	256
#define      pswd	((&data[4]))
	"\333\212\072\002\363\326\103\223\015\306\146\311\276\010\333\246"
	"\203\045\131\067\340\141\132\061\066\307\015\145\136\240\374\163"
	"\224\212\166\207\140\271\032\155\200\201\067\077\211\023\346\015"
	"\070\077\105\030\240\237\111\327\147\127\074\305\367\071\070\213"
	"\303\257\023\043\151\055\221\351\257\311\051\071\334\017\106\024"
	"\116\213\055\357\053\167\307\222\316\004\127\306\075\220\122\000"
	"\100\145\044\251\222\266\223\102\177\274\173\134\314\301\161\032"
	"\115\236\011\170\026\321\013\344\325\143\253\022\364\375\023\064"
	"\142\070\336\365\356\161\067\156\056\262\312\372\164\073\024\301"
	"\332\036\072\360\357\106\325\304\251\200\327\235\175\352\322\337"
	"\042\260\324\021\041\014\200\120\276\112\112\062\206\137\364\140"
	"\176\056\121\155\164\046\062\036\246\011\274\043\364\216\003\027"
	"\076\330\051\140\344\251\260\243\364\373\326\172\132\312\333\330"
	"\371\054\106\156\123\171\214\371\202\110\035\167\327\041\216\025"
	"\371\267\166\336\140\047\202\124\042\130\317\175\042\253\126\034"
	"\330\234\212\053\025\027\045\230\140\103\017\067\144\236\115\136"
	"\126\303\075\206\341\126\137\175"
#define      tst2_z	19
#define      tst2	((&data[267]))
	"\371\260\220\355\106\057\102\002\307\314\317\031\224\364\315\241"
	"\150\005\343\274\171\053\132"
#define      chk2_z	19
#define      chk2	((&data[289]))
	"\130\271\064\131\354\055\050\166\050\151\341\151\266\330\107\312"
	"\001\140\101\134\332\337"
#define      opts_z	1
#define      opts	((&data[310]))
	"\265"
#define      msg1_z	42
#define      msg1	((&data[320]))
	"\263\363\234\312\317\046\005\126\010\114\144\334\151\144\053\033"
	"\175\205\002\300\222\045\263\221\114\112\165\211\144\157\372\002"
	"\200\177\041\331\074\270\270\177\272\023\175\004\251\366\017\013"
	"\206\123\313\134\265\205\076\100\031"
#define      shll_z	8
#define      shll	((&data[370]))
	"\221\344\305\262\316\212\001\354\153\225"
#define      tst1_z	22
#define      tst1	((&data[378]))
	"\010\227\207\262\034\024\131\106\122\217\264\150\037\114\052\331"
	"\004\215\070\056\015\260\133"
#define      date_z	1
#define      date	((&data[401]))
	"\300"
#define      msg2_z	19
#define      msg2	((&data[406]))
	"\064\233\147\320\021\304\162\356\220\315\317\066\207\375\364\173"
	"\301\176\004\272\076\331\350\146\066"
#define      inlo_z	3
#define      inlo	((&data[427]))
	"\003\041\143"
#define      xecc_z	15
#define      xecc	((&data[433]))
	"\205\006\203\376\311\236\316\313\202\112\322\266\033\260\063\253"
	"\201\243\236"
#define      lsto_z	1
#define      lsto	((&data[449]))
	"\172"
#define      text_z	3086
#define      text	((&data[718]))
	"\363\226\300\367\212\113\235\162\277\322\016\046\243\165\135\232"
	"\341\352\232\251\055\040\260\261\277\356\045\243\277\177\007\263"
	"\025\307\252\237\023\107\022\323\032\041\372\275\226\130\130\167"
	"\103\363\041\160\023\321\042\322\300\110\165\177\307\175\062\334"
	"\105\334\174\131\044\217\054\076\260\047\373\106\177\123\276\302"
	"\106\337\063\132\260\125\054\161\235\242\360\144\040\042\101\145"
	"\377\275\277\043\115\353\141\375\022\134\104\222\260\002\124\367"
	"\341\207\121\222\334\176\003\172\041\364\336\101\027\040\247\026"
	"\335\146\071\053\122\233\050\145\370\154\367\250\156\113\237\120"
	"\322\361\343\257\157\347\051\221\333\010\322\362\050\171\010\006"
	"\337\102\061\061\335\131\226\325\306\216\176\065\331\036\206\254"
	"\017\151\133\177\120\204\020\054\215\342\037\265\134\047\274\074"
	"\152\355\156\107\107\005\035\016\223\233\103\154\271\312\030\310"
	"\063\164\110\204\370\131\260\205\074\317\073\230\367\367\324\142"
	"\345\102\251\055\110\307\073\333\142\177\110\033\111\140\344\175"
	"\324\055\001\315\206\262\123\302\202\217\133\172\207\057\334\154"
	"\162\206\232\272\115\325\226\257\125\336\313\237\236\123\147\161"
	"\246\317\337\061\267\132\251\255\105\353\355\035\073\006\134\067"
	"\041\360\176\111\017\145\201\364\236\201\250\032\266\237\075\010"
	"\064\007\016\276\370\020\305\033\114\363\055\303\270\043\206\244"
	"\210\076\217\333\021\016\236\177\233\001\335\377\313\061\263\272"
	"\233\311\325\254\350\072\123\232\357\177\307\120\025\250\304\112"
	"\105\135\037\377\131\005\025\247\023\364\113\005\170\114\026\172"
	"\015\355\341\216\312\224\156\345\215\276\275\100\044\065\067\010"
	"\036\326\333\103\250\055\366\123\157\345\334\245\301\010\265\361"
	"\270\312\206\000\031\061\237\347\237\327\345\104\357\056\327\125"
	"\315\017\333\124\140\111\235\247\270\371\362\247\107\112\266\145"
	"\304\304\271\064\011\103\110\343\112\327\040\125\066\316\306\261"
	"\034\367\163\326\257\303\365\070\322\033\134\043\262\022\052\046"
	"\341\333\227\014\230\174\143\336\250\101\215\217\213\351\317\026"
	"\234\164\247\237\175\012\104\316\025\175\176\112\050\127\360\157"
	"\010\012\226\231\250\125\110\205\201\376\245\353\034\352\355\150"
	"\137\302\060\224\145\173\075\206\300\024\226\236\325\141\155\173"
	"\136\265\253\245\016\120\173\346\222\233\106\062\157\277\143\271"
	"\063\234\276\325\357\012\060\334\303\034\177\251\323\110\031\230"
	"\244\327\077\242\023\354\111\011\304\172\261\275\127\222\310\057"
	"\017\267\022\000\247\225\304\074\341\372\250\263\270\276\272\051"
	"\234\363\215\210\006\336\331\102\266\126\166\167\103\321\347\257"
	"\070\262\232\155\357\055\314\352\311\103\155\116\007\303\122\026"
	"\056\042\137\053\247\071\132\111\322\213\056\124\362\107\277\323"
	"\215\367\002\217\133\347\056\202\067\362\352\073\102\260\004\052"
	"\274\125\064\233\020\242\313\151\123\052\314\327\174\144\132\277"
	"\272\072\133\212\254\261\007\200\324\056\330\342\165\045\364\210"
	"\226\145\232\057\347\113\350\210\363\231\134\315\013\164\115\347"
	"\137\362\331\071\064\204\311\032\221\047\003\232\136\225\003\021"
	"\307\110\002\277\377\050\041\113\257\351\357\044\207\055\135\321"
	"\073\302\102\151\111\002\211\164\230\152\202\125\140\156\216\141"
	"\345\270\371\010\213\071\167\372\116\240\343\331\212\246\333\002"
	"\113\016\066\015\064\126\324\254\340\110\144\304\204\352\327\270"
	"\323\113\220\113\300\075\303\147\232\263\131\311\162\370\013\166"
	"\044\173\252\233\225\013\116\155\161\165\247\303\050\152\267\025"
	"\103\305\007\204\054\376\336\115\335\015\300\377\153\346\067\273"
	"\357\277\137\226\174\262\100\272\114\004\106\020\066\214\151\105"
	"\204\220\362\372\164\261\360\160\262\301\356\064\220\343\161\012"
	"\012\100\264\163\315\325\234\272\225\100\022\257\107\141\166\233"
	"\043\300\130\215\372\351\045\353\206\273\254\207\032\230\347\010"
	"\271\147\221\364\335\117\216\220\337\336\122\127\141\110\035\267"
	"\373\222\064\030\150\274\216\360\304\114\153\201\377\225\364\057"
	"\103\176\053\241\157\223\253\261\341\351\007\243\321\006\127\215"
	"\243\077\140\333\076\167\206\202\255\061\054\127\003\215\245\241"
	"\362\005\173\120\154\263\376\012\073\352\254\345\315\343\135\343"
	"\310\311\272\221\106\056\131\343\133\361\360\131\270\174\055\113"
	"\305\343\153\264\364\116\015\072\262\043\213\276\046\032\140\147"
	"\367\362\107\225\070\321\255\350\210\204\265\234\172\054\361\216"
	"\041\362\141\034\226\222\173\244\377\116\271\273\262\267\212\153"
	"\316\107\142\376\137\370\057\033\216\000\052\050\103\103\171\135"
	"\134\346\026\313\223\311\277\355\375\142\057\174\121\056\322\154"
	"\002\130\251\164\214\356\134\224\104\224\257\231\325\124\260\045"
	"\013\225\355\116\070\117\224\276\177\212\264\266\323\155\213\010"
	"\047\270\140\054\041\223\031\276\103\140\260\323\223\176\030\210"
	"\141\051\133\244\256\135\006\150\246\140\222\310\265\137\346\066"
	"\277\070\322\000\263\325\004\262\346\247\265\303\112\154\300\236"
	"\027\110\374\310\123\327\214\340\117\254\367\135\240\171\353\101"
	"\233\256\240\304\013\334\151\202\205\303\245\027\123\244\215\044"
	"\250\142\044\057\146\172\275\204\300\240\245\264\323\015\174\222"
	"\333\344\224\100\304\153\253\010\370\272\377\110\047\012\241\255"
	"\342\265\342\155\247\314\061\334\206\374\213\326\113\277\030\053"
	"\165\160\213\120\011\224\223\106\205\112\225\103\167\222\262\262"
	"\135\062\235\206\017\314\363\012\310\222\302\107\247\267\371\342"
	"\247\352\040\233\341\172\050\056\131\051\267\304\040\031\250\224"
	"\340\263\335\224\256\145\316\113\126\102\147\375\002\263\311\050"
	"\252\027\142\350\305\066\021\313\260\212\246\145\067\237\035\240"
	"\220\130\074\330\166\267\233\172\135\346\175\341\024\167\203\360"
	"\170\031\242\011\102\340\252\075\104\151\132\101\245\236\263\345"
	"\270\132\237\300\225\210\322\102\025\024\015\230\245\126\253\225"
	"\226\225\022\240\315\176\031\330\307\243\303\153\313\157\106\076"
	"\122\320\002\113\064\345\116\021\366\052\124\262\173\100\155\021"
	"\332\322\053\300\003\275\264\121\011\341\370\223\375\245\273\046"
	"\245\376\125\255\031\061\336\051\061\022\063\325\203\011\062\004"
	"\113\314\115\322\050\021\137\303\173\217\125\072\246\360\076\115"
	"\073\325\001\104\263\204\104\017\337\101\063\036\164\344\263\212"
	"\327\016\334\313\036\173\301\064\160\331\053\175\026\076\005\337"
	"\263\301\240\264\342\263\073\113\053\244\125\174\112\025\131\175"
	"\052\337\305\104\112\067\370\163\252\213\074\375\205\017\071\152"
	"\300\057\215\316\037\325\265\116\115\124\303\234\310\203\326\206"
	"\310\021\040\056\104\127\226\337\036\143\152\375\341\225\212\063"
	"\262\027\150\036\325\146\036\031\123\126\220\240\017\212\172\153"
	"\002\143\230\303\155\017\315\163\354\236\114\045\112\330\263\301"
	"\236\356\145\160\055\353\064\212\307\200\206\156\373\022\106\162"
	"\165\123\244\237\140\340\037\041\347\322\271\126\353\237\371\261"
	"\175\370\122\172\031\267\105\301\165\165\100\176\161\176\244\323"
	"\105\052\332\307\314\252\025\334\104\144\272\257\263\233\046\346"
	"\352\320\000\000\011\253\246\032\226\261\202\340\116\330\352\262"
	"\325\047\003\316\231\357\303\241\164\276\033\345\217\006\272\050"
	"\070\021\011\101\314\131\104\335\346\024\314\176\365\363\206\043"
	"\217\362\042\071\034\264\266\075\054\016\015\360\142\342\026\157"
	"\272\363\177\265\341\335\031\365\371\242\207\345\170\256\342\156"
	"\002\013\161\077\212\255\007\327\272\231\241\203\246\377\004\252"
	"\274\167\137\201\355\052\235\044\135\164\316\142\013\046\020\364"
	"\302\070\077\006\115\022\207\336\306\225\336\070\217\250\017\026"
	"\243\255\266\025\155\307\245\326\263\377\026\015\354\211\311\136"
	"\237\342\122\004\311\120\300\345\321\265\151\267\037\117\135\320"
	"\320\246\002\253\105\252\313\247\042\376\364\375\047\155\247\122"
	"\255\267\010\316\170\171\216\337\334\071\014\067\333\170\144\301"
	"\354\103\001\377\103\314\136\240\140\360\064\227\210\120\203\347"
	"\047\017\054\236\253\263\370\122\357\316\062\247\362\126\172\366"
	"\373\043\020\232\344\231\012\152\271\313\235\122\107\143\141\204"
	"\314\151\361\316\201\007\301\116\037\141\310\103\215\164\030\316"
	"\056\155\012\015\246\301\202\265\365\351\073\234\256\334\315\316"
	"\076\247\061\202\247\301\147\232\221\025\262\362\247\332\277\323"
	"\215\206\036\123\274\266\275\204\160\245\337\145\315\157\366\277"
	"\346\034\224\062\201\016\367\020\207\067\041\107\343\276\321\210"
	"\327\152\004\116\261\100\114\203\313\221\057\372\351\316\046\220"
	"\010\374\146\130\234\004\300\344\137\007\210\322\357\236\365\245"
	"\240\145\011\102\355\047\055\075\146\340\351\042\267\343\334\306"
	"\163\003\071\246\311\312\360\307\243\016\370\324\062\055\362\325"
	"\340\365\061\123\201\364\126\145\111\341\114\126\320\230\266\115"
	"\100\343\254\065\126\110\360\051\270\052\103\131\153\066\024\323"
	"\210\017\141\161\112\103\217\323\324\075\334\074\156\151\060\352"
	"\142\261\300\077\335\126\360\036\107\362\143\372\132\073\217\065"
	"\045\216\006\065\274\124\202\263\227\070\100\111\161\034\234\242"
	"\175\361\305\331\145\345\344\275\064\136\215\114\301\047\074\230"
	"\076\202\246\105\170\107\247\167\217\220\350\045\315\313\152\077"
	"\276\173\223\330\154\106\023\373\040\236\232\015\204\004\173\354"
	"\245\063\223\253\151\107\206\203\333\277\355\275\363\326\172\206"
	"\016\003\214\303\363\360\320\115\271\136\056\332\225\317\302\214"
	"\325\163\046\027\060\165\377\363\373\166\204\154\032\013\062\361"
	"\203\206\325\237\324\227\240\267\225\056\023\217\274\325\037\016"
	"\244\141\020\121\072\111\002\011\337\200\044\015\064\366\240\344"
	"\346\322\057\105\323\250\052\375\001\235\005\120\231\070\303\122"
	"\263\250\233\070\215\300\016\065\317\337\045\102\204\242\345\371"
	"\376\217\246\360\206\172\237\271\346\264\224\334\177\135\051\205"
	"\306\032\243\335\301\167\006\323\361\044\000\160\264\120\067\305"
	"\373\075\000\333\167\160\302\162\322\161\107\114\014\132\042\160"
	"\323\232\104\313\066\276\333\061\157\161\162\260\023\330\242\055"
	"\070\053\043\326\174\131\034\022\011\141\007\133\044\126\165\233"
	"\264\075\300\162\035\135\117\226\376\310\212\102\056\015\311\276"
	"\236\041\024\271\113\156\367\357\046\170\104\023\340\154\175\126"
	"\010\244\325\371\010\302\167\173\241\077\310\320\270\176\255\345"
	"\016\337\137\353\052\101\220\202\130\332\364\000\262\136\244\301"
	"\340\050\011\023\044\162\240\015\147\073\010\323\161\343\023\313"
	"\060\344\107\313\112\021\013\154\347\206\231\361\030\061\070\344"
	"\101\113\342\020\345\322\207\372\136\364\045\234\275\221\204\163"
	"\036\360\331\235\341\132\007\365\035\321\113\011\256\313\112\354"
	"\104\012\237\356\352\373\102\026\240\142\020\227\257\243\310\172"
	"\073\122\206\113\154\017\171\065\263\060\241\300\272\340\242\343"
	"\121\035\206\244\154\263\263\266\006\204\115\134\125\224\375\371"
	"\350\143\011\370\316\244\165\227\156\176\004\322\032\153\332\213"
	"\240\041\104\031\071\146\256\303\056\003\177\147\163\044\167\271"
	"\335\336\365\031\233\264\353\220\024\350\275\224\155\027\177\314"
	"\027\237\231\160\065\274\014\324\031\037\113\067\027\217\053\235"
	"\271\234\234\337\267\331\217\220\140\150\044\145\132\106\377\125"
	"\167\214\256\226\207\203\324\220\101\165\152\353\272\231\320\254"
	"\236\305\022\360\201\364\317\326\364\247\200\341\270\265\133\345"
	"\212\215\045\133\032\111\254\113\346\301\231\370\040\340\246\053"
	"\160\324\234\072\054\313\067\361\141\031\033\051\216\220\045\206"
	"\177\025\026\262\270\204\265\304\101\023\003\153\037\065\161\342"
	"\110\313\377\265\344\125\065\333\247\330\053\062\341\326\234\134"
	"\121\341\111\167\242\327\126\050\151\170\356\023\375\035\137\077"
	"\316\261\336\004\357\321\277\032\356\303\224\266\173\151\126\042"
	"\042\062\155\311\012\165\115\263\166\066\011\326\043\330\335\014"
	"\263\105\062\033\056\145\163\166\371\332\175\265\165\062\226\015"
	"\071\337\247\155\301\131\320\172\147\247\065\342\341\176\053\326"
	"\357\233\264\237\062\160\262\015\264\054\312\060\157\216\203\257"
	"\364\035\000\357\225\037\053\232\317\063\007\230\171\200\020\107"
	"\165\115\354\133\365\112\010\261\263\034\321\026\173\216\035\240"
	"\324\122\140\115\246\035\110\310\273\357\271\122\114\034\235\174"
	"\126\052\210\322\213\341\212\047\164\026\150\355\026\104\165\106"
	"\173\003\042\123\061\124\220\273\016\212\176\035\061\070\173\142"
	"\225\024\251\162\272\072\303\127\145\112\022\242\250\335\363\215"
	"\152\041\142\044\315\277\072\342\222\325\322\051\310\001\136\012"
	"\163\326\335\162\336\375\336\041\306\321\364\337\215\174\134\202"
	"\043\061\231\221\376\003\362\347\016\220\310\000\107\106\200\200"
	"\231\033\017\257\205\312\020\063\170\235\203\230\143\017\250\011"
	"\053\013\272\344\345\260\316\074\345\060\162\272\375\170\264\160"
	"\200\050\136\320\143\051\027\275\144\175\261\165\071\327\375\224"
	"\375\017\040\035\271\144\317\217\366\213\302\227\100\226\272\077"
	"\370\317\001\154\147\312\021\121\005\156\106\207\322\162\056\103"
	"\305\155\256\316\233\061\021\035\350\315\306\261\057\073\216\323"
	"\155\372\370\171\362\140\315\034\206\053\275\154\276\175\273\071"
	"\015\042\350\322\167\155\007\254\147\341\370\270\146\327\316\163"
	"\253\134\234\377\377\366\077\031\053\157\267\001\126\104\225\367"
	"\046\217\210\255\260\230\377\066\131\230\227\264\022\342\176\047"
	"\177\341\276\055\166\253\265\222\263\242\375\257\106\141\120\015"
	"\124\034\277\037\316\306\247\252\366\317\146\131\335\035\124\212"
	"\376\307\051\363\025\054\335\273\260\216\067\335\263\207\223\100"
	"\224\017\215\074\266\276\201\022\335\303\314\061\203\261\177\137"
	"\345\346\374\253\040\027\152\204\121\343\134\136\041\037\314\152"
	"\020\315\174\157\310\065\040\271\163\210\010\366\043\313\037\100"
	"\231\354\077\262\155\322\235\350\343\336\155\032\317\161\101\173"
	"\220\320\345\057\373\361\132\234\272\277\040\075\370\170\153\252"
	"\376\333\371\237\340\133\321\004\106\133\021\023\002\036\117\361"
	"\254\340\046\315\166\112\041\147\130\235\236\337\150\117\270\265"
	"\332\037\256\312\330\052\141\322\235\132\322\367\074\274\026\363"
	"\074\143\166\053\004\200\045\140\233\054\161\310\262\133\301\315"
	"\303\327\271\174\237\257\351\347\075\371\337\377\224\331\357\030"
	"\336\344\352\170\372\255\070\005\307\000\156\212\142\235\361\276"
	"\157\122\042\116\116\006\307\041\203\231\314\201\332\170\062\264"
	"\320\005\201\154\135\256\111\136\310\141\303\272\243\032\032\101"
	"\372\145\242\036\215\074\061\350\361\313\077\260\034\024\335\036"
	"\341\143\320\065\046\123\304\201\315\113\261\252\270\044\060\122"
	"\336\175\050\165\055\175\123\370\034\222\250\071\246\206\127\210"
	"\352\050\275\020\173\202\222\111\315\103\364\205\147\044\330\106"
	"\242\000\273\317\175\017\310\232\242\161\323\110\370\052\321\342"
	"\122\217\363\316\021\205\030\337\310\014\145\060\060\075\166\323"
	"\075\062\243\272\101\153\124\343\335\047\054\325\122\375\267\244"
	"\215\253\163\236\060\213\175\370\230\342\050\310\037\237\234\134"
	"\321\077\027\022\253\154\366\210\224\042\135\346\040\025\213\255"
	"\300\377\114\361\212\311\351\042\254\022\353\313\262\210\050\203"
	"\307\100\226\162\254\214\373\101\257\131\047\320\156\263\176\057"
	"\262\312\040\075\223\012\140\100\035\114\013\317\324\064\123\233"
	"\165\351\016\041\166\011\142\046\142\212\366\321\076\164\001\360"
	"\076\042\055\322\054\216\022\112\332\036\032\256\123\155\111\310"
	"\127\130\352\316\141\115\364\304\330\353\226\026\140\227\007\236"
	"\272\064\161\346\302\204\061\235\243\114\113\367\271\225\300\021"
	"\355\252\340\117\370\324\024\320\277\252\347\037\102\356\276\374"
	"\043\060\343\346\265\025\203\130\141\316\120\033\143\020\055\121"
	"\272\015\241\263\341\265\204\241\140\153\301\242\131\200\237\175"
	"\261\202\143\146\230\346\277\371\265"
#define      chk1_z	22
#define      chk1	((&data[4107]))
	"\056\144\235\251\246\254\016\325\165\173\267\201\016\037\327\055"
	"\255\157\031\121\065\112"/* End of data[] */;
#define      hide_z	4096
#define DEBUGEXEC	0	/* Define as 1 to debug execvp calls */
#define TRACEABLE	1	/* Define as 1 to enable ptrace the executable */

/* rtc.c */

#include <sys/stat.h>
#include <sys/types.h>

#include <errno.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <time.h>
#include <unistd.h>

/* 'Alleged RC4' */

static unsigned char stte[256], indx, jndx, kndx;

/*
 * Reset arc4 stte. 
 */
void stte_0(void)
{
	indx = jndx = kndx = 0;
	do {
		stte[indx] = indx;
	} while (++indx);
}

/*
 * Set key. Can be used more than once. 
 */
void key(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		do {
			tmp = stte[indx];
			kndx += tmp;
			kndx += ptr[(int)indx % len];
			stte[indx] = stte[kndx];
			stte[kndx] = tmp;
		} while (++indx);
		ptr += 256;
		len -= 256;
	}
}

/*
 * Crypt data. 
 */
void arc4(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		indx++;
		tmp = stte[indx];
		jndx += tmp;
		stte[indx] = stte[jndx];
		stte[jndx] = tmp;
		tmp += stte[indx];
		*ptr ^= stte[tmp];
		ptr++;
		len--;
	}
}

/* End of ARC4 */

/*
 * Key with file invariants. 
 */
int key_with_file(char * file)
{
	struct stat statf[1];
	struct stat control[1];

	if (stat(file, statf) < 0)
		return -1;

	/* Turn on stable fields */
	memset(control, 0, sizeof(control));
	control->st_ino = statf->st_ino;
	control->st_dev = statf->st_dev;
	control->st_rdev = statf->st_rdev;
	control->st_uid = statf->st_uid;
	control->st_gid = statf->st_gid;
	control->st_size = statf->st_size;
	control->st_mtime = statf->st_mtime;
	control->st_ctime = statf->st_ctime;
	key(control, sizeof(control));
	return 0;
}

#if DEBUGEXEC
void debugexec(char * sh11, int argc, char ** argv)
{
	int i;
	fprintf(stderr, "shll=%s\n", sh11 ? sh11 : "<null>");
	fprintf(stderr, "argc=%d\n", argc);
	if (!argv) {
		fprintf(stderr, "argv=<null>\n");
	} else { 
		for (i = 0; i <= argc ; i++)
			fprintf(stderr, "argv[%d]=%.60s\n", i, argv[i] ? argv[i] : "<null>");
	}
}
#endif /* DEBUGEXEC */

void rmarg(char ** argv, char * arg)
{
	for (; argv && *argv && *argv != arg; argv++);
	for (; argv && *argv; argv++)
		*argv = argv[1];
}

int chkenv(int argc)
{
	char buff[512];
	unsigned long mask, m;
	int l, a, c;
	char * string;
	extern char ** environ;

	mask  = (unsigned long)&chkenv;
	mask ^= (unsigned long)getpid() * ~mask;
	sprintf(buff, "x%lx", mask);
	string = getenv(buff);
#if DEBUGEXEC
	fprintf(stderr, "getenv(%s)=%s\n", buff, string ? string : "<null>");
#endif
	l = strlen(buff);
	if (!string) {
		/* 1st */
		sprintf(&buff[l], "=%lu %d", mask, argc);
		putenv(strdup(buff));
		return 0;
	}
	c = sscanf(string, "%lu %d%c", &m, &a, buff);
	if (c == 2 && m == mask) {
		/* 3rd */
		rmarg(environ, &string[-l - 1]);
		return 1 + (argc - a);
	}
	return -1;
}

#if !TRACEABLE

#define _LINUX_SOURCE_COMPAT
#include <sys/ptrace.h>
#include <sys/types.h>
#include <sys/wait.h>
#include <fcntl.h>
#include <signal.h>
#include <stdio.h>
#include <unistd.h>

#if !defined(PTRACE_ATTACH) && defined(PT_ATTACH)
#	define PTRACE_ATTACH	PT_ATTACH
#endif
void untraceable(char * argv0)
{
	char proc[80];
	int pid, mine;

	switch(pid = fork()) {
	case  0:
		pid = getppid();
		/* For problematic SunOS ptrace */
#if defined(__FreeBSD__)
		sprintf(proc, "/proc/%d/mem", (int)pid);
#else
		sprintf(proc, "/proc/%d/as",  (int)pid);
#endif
		close(0);
		mine = !open(proc, O_RDWR|O_EXCL);
		if (!mine && errno != EBUSY)
			mine = !ptrace(PTRACE_ATTACH, pid, 0, 0);
		if (mine) {
			kill(pid, SIGCONT);
		} else {
			perror(argv0);
			kill(pid, SIGKILL);
		}
		_exit(mine);
	case -1:
		break;
	default:
		if (pid == waitpid(pid, 0, 0))
			return;
	}
	perror(argv0);
	_exit(1);
}
#endif /* !TRACEABLE */

char * xsh(int argc, char ** argv)
{
	char * scrpt;
	int ret, i, j;
	char ** varg;

	stte_0();
	 key(pswd, pswd_z);
	arc4(msg1, msg1_z);
	arc4(date, date_z);
	if (date[0] && (atoll(date)<time(NULL)))
		return msg1;
	arc4(shll, shll_z);
	arc4(inlo, inlo_z);
	arc4(xecc, xecc_z);
	arc4(lsto, lsto_z);
	arc4(tst1, tst1_z);
	 key(tst1, tst1_z);
	arc4(chk1, chk1_z);
	if ((chk1_z != tst1_z) || memcmp(tst1, chk1, tst1_z))
		return tst1;
	ret = chkenv(argc);
	arc4(msg2, msg2_z);
	if (ret < 0)
		return msg2;
	varg = (char **)calloc(argc + 10, sizeof(char *));
	if (!varg)
		return 0;
	if (ret) {
		arc4(rlax, rlax_z);
		if (!rlax[0] && key_with_file(shll))
			return shll;
		arc4(opts, opts_z);
		arc4(text, text_z);
		arc4(tst2, tst2_z);
		 key(tst2, tst2_z);
		arc4(chk2, chk2_z);
		if ((chk2_z != tst2_z) || memcmp(tst2, chk2, tst2_z))
			return tst2;
		if (text_z < hide_z) {
			/* Prepend spaces til a hide_z script size. */
			scrpt = malloc(hide_z);
			if (!scrpt)
				return 0;
			memset(scrpt, (int) ' ', hide_z);
			memcpy(&scrpt[hide_z - text_z], text, text_z);
		} else {
			scrpt = text;	/* Script text */
		}
	} else {			/* Reexecute */
		if (*xecc) {
			scrpt = malloc(512);
			if (!scrpt)
				return 0;
			sprintf(scrpt, xecc, argv[0]);
		} else {
			scrpt = argv[0];
		}
	}
	j = 0;
	varg[j++] = argv[0];		/* My own name at execution */
	if (ret && *opts)
		varg[j++] = opts;	/* Options on 1st line of code */
	if (*inlo)
		varg[j++] = inlo;	/* Option introducing inline code */
	varg[j++] = scrpt;		/* The script itself */
	if (*lsto)
		varg[j++] = lsto;	/* Option meaning last option */
	i = (ret > 1) ? ret : 0;	/* Args numbering correction */
	while (i < argc)
		varg[j++] = argv[i++];	/* Main run-time arguments */
	varg[j] = 0;			/* NULL terminated array */
#if DEBUGEXEC
	debugexec(shll, j, varg);
#endif
	execvp(shll, varg);
	return shll;
}

int main(int argc, char ** argv)
{
#if DEBUGEXEC
	debugexec("main", argc, argv);
#endif
#if !TRACEABLE
	untraceable(argv[0]);
#endif
	argv[1] = xsh(argc, argv);
	fprintf(stderr, "%s%s%s: %s\n", argv[0],
		errno ? ": " : "",
		errno ? strerror(errno) : "",
		argv[1] ? argv[1] : "<null>"
	);
	return 1;
}
